#!/usr/bin/env php
<?php declare(strict_types=1);

require __DIR__ . '/../bootstrap/cli.php';

use App\Core\DB;
use App\Core\Migrator;

$pdo = DB::pdo();
$mgr = new Migrator($pdo, dirname(__DIR__) . '/database/migrations');

$cmd = $argv[1] ?? 'status';
switch ($cmd) {
    case 'up':
        $mgr->up($argv[2] ?? null); // optional target filename
        break;
    case 'down':
        $steps = isset($argv[2]) ? (int)$argv[2] : 1;
        $mgr->down($steps);
        break;
    case 'status':
    default:
        $mgr->status();
        break;
}
